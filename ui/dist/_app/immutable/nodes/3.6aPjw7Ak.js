import"../chunks/DsnmJJEf.js";import{p as k,d as v,f as h,g as c,c as M,i as d,j as _,k as x,l as F,m as w,a as S,b as C,h as I,s as R,t as U,$ as b}from"../chunks/DwQzyupF.js";import{i as y}from"../chunks/rhY9p7tb.js";import{C as j,g as E}from"../chunks/DjLVYbZw.js";import{p as f}from"../chunks/DAyQD9Rl.js";import{j as T,k as D,M as L,T as N}from"../chunks/LAAhDiRE.js";var W=x('<div class="workspace peer m-3 h-[60vh] border-2 border-base-100/30 md:m-0 md:h-dvh md:max-h-dvh md:w-3/4"><!></div>');function $(u,n){k(n,!0);let e=_(()=>{for(const t of n.messages.toReversed())for(const r of(t.items??[]).toReversed())if(r.type==="tool"&&r.output&&r.output?.content){for(const a of r.output.content.toReversed())if(T(a)&&a.resource._meta?.["ai.nanobot.meta/workspace"])return a}return null}),g=_(()=>d(e)?.resource?.text??d(e)?.resource?.blob??"");var s=v(),m=h(s);{var l=t=>{var r=v(),a=h(r);D(a,()=>d(g),p=>{var i=W(),o=F(i);L(o,{get item(){return d(e)},get onSend(){return n.onSendMessage}}),w(i),c(p,i)}),c(t,r)};y(m,t=>{d(g)&&t(l)})}c(u,s),M()}var q=x('<div class="grid grid-cols-1 md:flex md:flex-row"><!> <!></div>');function K(u,n){k(n,!0);const e=f.data.chat||new j,g=E();S(()=>{f.params.id&&e.setChatId(f.params.id).catch(t=>{console.error("Error setting chat ID:",t),g.error(t.message)})}),C(()=>{e.close()});var s=q();I(t=>{var r=v(),a=h(r);{var p=o=>{U(()=>b.title=e.agent.name)},i=o=>{b.title="Nanobot"};y(a,o=>{e.agent?.name?o(p):o(i,!1)})}c(t,r)});var m=F(s);$(m,{get messages(){return e.messages},get onSendMessage(){return e.sendMessage}});var l=R(m,2);N(l,{get messages(){return e.messages},get isLoading(){return e.isLoading},get onFileUpload(){return e.uploadFile},get onSendMessage(){return e.sendMessage},get cancelUpload(){return e.cancelUpload},get prompts(){return e.prompts},get resources(){return e.resources},get elicitations(){return e.elicitations},get agent(){return e.agent},get uploadingFiles(){return e.uploadingFiles},get uploadedFiles(){return e.uploadedFiles},get onElicitationResult(){return e.replyToElicitation}}),w(s),c(u,s),M()}export{K as component};
