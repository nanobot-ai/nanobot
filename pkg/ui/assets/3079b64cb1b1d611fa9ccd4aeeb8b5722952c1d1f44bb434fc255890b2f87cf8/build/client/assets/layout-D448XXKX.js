import{r as u,j as e,A as S,B as N,F as z,w as je,O as me}from"./chunk-QMGIS6GS-DfTvyqh6.js";import{c as ge,w as G,x as ve,u as H,W as be,d as De,y as ye,e as Ne,z as we,T as Ae,E as Ce,G as W,H as Se,O as Me,J as Te,a as m,K as Y,L as _e,S as M,M as T,N as _,Q as k,U as O,X as B,Y as P,Z as U,_ as V,$ as K,a0 as q,a1 as J,a2 as h,a3 as Q,a4 as y,a5 as X,a6 as Z,a7 as E,a8 as A,a9 as C,aa as w,ab as ke,ac as Oe,ad as ee,ae as Pe,af as Ee,ag as Re,ah as Ie,ai as $e,B as Le,aj as Fe,ak as ze,al as Ge,am as He,an as We}from"./use-chat-BHBTbUC_.js";import{t as Ye}from"./index-_SmGZh4S.js";import{u as Be,a as I}from"./index-DxM-FJDF.js";import{C as Ue}from"./chevron-up-BrjaNDif.js";import"./index-DnWePWqS.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Ke=ge("pencil",Ve),$=Symbol.for("constructDateFrom");function j(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&$ in t?t[$](s):t instanceof Date?new t.constructor(s):new Date(s)}function R(t,s){return j(t,t)}function te(t,s,r){const a=R(t);return isNaN(s)?j(t,NaN):(s&&a.setDate(a.getDate()+s),a)}function qe(t,s,r){const a=R(t);if(isNaN(s))return j(t,NaN);const n=a.getDate(),o=j(t,a.getTime());o.setMonth(a.getMonth()+s+1,0);const i=o.getDate();return n>=i?o:(a.setFullYear(o.getFullYear(),o.getMonth(),n),a)}function Je(t,...s){const r=j.bind(null,s.find(a=>typeof a=="object"));return s.map(r)}function L(t,s){const r=R(t);return r.setHours(0,0,0,0),r}function Qe(t,s,r){return te(t,s*7)}function se(t){return j(t,Date.now())}function ae(t,s,r){const[a,n]=Je(r==null?void 0:r.in,t,s);return+L(a)==+L(n)}function Xe(t,s){return ae(j(t,t),se(t))}function Ze(t,s,r){return te(t,-1)}function et(t,s){return ae(j(t,t),Ze(se(t)))}function tt(t,s,r){return qe(t,-1)}function st(t,s,r){return Qe(t,-1)}var re="AlertDialog",[at,Wt]=De(re,[G]),f=G(),ne=t=>{const{__scopeAlertDialog:s,...r}=t,a=f(s);return e.jsx(ve,{...a,...r,modal:!0})};ne.displayName=re;var rt="AlertDialogTrigger",nt=u.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,n=f(r);return e.jsx(Te,{...n,...a,ref:s})});nt.displayName=rt;var ot="AlertDialogPortal",oe=t=>{const{__scopeAlertDialog:s,...r}=t,a=f(s);return e.jsx(Se,{...a,...r})};oe.displayName=ot;var it="AlertDialogOverlay",ie=u.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,n=f(r);return e.jsx(Me,{...n,...a,ref:s})});ie.displayName=it;var v="AlertDialogContent",[lt,ct]=at(v),dt=we("AlertDialogContent"),le=u.forwardRef((t,s)=>{const{__scopeAlertDialog:r,children:a,...n}=t,o=f(r),i=u.useRef(null),c=H(s,i),g=u.useRef(null);return e.jsx(be,{contentName:v,titleName:ce,docsSlug:"alert-dialog",children:e.jsx(lt,{scope:r,cancelRef:g,children:e.jsxs(ye,{role:"alertdialog",...o,...n,ref:c,onOpenAutoFocus:Ne(n.onOpenAutoFocus,d=>{var D;d.preventDefault(),(D=g.current)==null||D.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[e.jsx(dt,{children:a}),e.jsx(xt,{contentRef:i})]})})})});le.displayName=v;var ce="AlertDialogTitle",de=u.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,n=f(r);return e.jsx(Ae,{...n,...a,ref:s})});de.displayName=ce;var ue="AlertDialogDescription",xe=u.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,n=f(r);return e.jsx(Ce,{...n,...a,ref:s})});xe.displayName=ue;var ut="AlertDialogAction",pe=u.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,n=f(r);return e.jsx(W,{...n,...a,ref:s})});pe.displayName=ut;var he="AlertDialogCancel",fe=u.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,{cancelRef:n}=ct(he,r),o=f(r),i=H(s,n);return e.jsx(W,{...o,...a,ref:i})});fe.displayName=he;var xt=({contentRef:t})=>{const s=`\`${v}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${v}\` by passing a \`${ue}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${v}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return u.useEffect(()=>{var a;document.getElementById((a=t.current)==null?void 0:a.getAttribute("aria-describedby"))||console.warn(s)},[s,t]),null},pt=ne,ht=oe,ft=ie,jt=le,mt=pe,gt=fe,vt=de,bt=xe;function Dt({...t}){return e.jsx(pt,{"data-slot":"alert-dialog",...t})}function yt({...t}){return e.jsx(ht,{"data-slot":"alert-dialog-portal",...t})}function Nt({className:t,...s}){return e.jsx(ft,{"data-slot":"alert-dialog-overlay",className:m("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function wt({className:t,...s}){return e.jsxs(yt,{children:[e.jsx(Nt,{}),e.jsx(jt,{"data-slot":"alert-dialog-content",className:m("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...s})]})}function At({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:m("flex flex-col gap-2 text-center sm:text-left",t),...s})}function Ct({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:m("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function St({className:t,...s}){return e.jsx(vt,{"data-slot":"alert-dialog-title",className:m("text-lg font-semibold",t),...s})}function Mt({className:t,...s}){return e.jsx(bt,{"data-slot":"alert-dialog-description",className:m("text-muted-foreground text-sm",t),...s})}function Tt({className:t,...s}){return e.jsx(mt,{className:m(Y(),t),...s})}function _t({className:t,...s}){return e.jsx(gt,{className:m(Y({variant:"outline"}),t),...s})}const kt=({chat:t,isActive:s,onDelete:r,setOpenMobile:a,user:n})=>{const[o,i]=_e({chatId:t.id});return e.jsxs(M,{children:[e.jsx(T,{asChild:!0,isActive:s,children:e.jsx(S,{to:`/chat/${t.id}`,onClick:()=>a(!1),children:e.jsx("span",{children:t.title})})}),e.jsxs(_,{modal:!0,children:[e.jsx(k,{asChild:!0,children:e.jsxs(O,{className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground mr-0.5",showOnHover:!s,children:[e.jsx(B,{}),e.jsx("span",{className:"sr-only",children:"More"})]})}),e.jsxs(P,{side:"bottom",align:"end",children:[n&&e.jsxs(U,{children:[e.jsx(V,{className:"cursor-pointer",children:e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(K,{}),e.jsx("span",{children:"Share"})]})}),e.jsx(q,{children:e.jsxs(J,{children:[e.jsxs(h,{className:"cursor-pointer flex-row justify-between",onClick:()=>{i("private")},children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(Q,{size:12}),e.jsx("span",{children:"Private"})]}),o==="private"?e.jsx(y,{}):null]}),e.jsxs(h,{className:"cursor-pointer flex-row justify-between",onClick:()=>{i("public")},children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(X,{}),e.jsx("span",{children:"Public"})]}),o==="public"?e.jsx(y,{}):null]})]})})]}),e.jsxs(h,{className:"cursor-pointer text-destructive focus:bg-destructive/15 focus:text-destructive dark:text-red-500",onSelect:()=>r(t.id),children:[e.jsx(Z,{}),e.jsx("span",{children:"Delete"})]})]})]})]})},b=u.memo(kt,(t,s)=>!(t.isActive!==s.isActive||t.chat.title!==s.chat.title||t.user!==s.user));function Ot(t){const s=new Date,r=st(s),a=tt(s);return t.reduce((n,o)=>{const i=new Date(o.created);return o.title&&(Xe(i)?n.today.push(o):et(i)?n.yesterday.push(o):i>r?n.lastWeek.push(o):i>a?n.lastMonth.push(o):n.older.push(o)),n},{today:[],yesterday:[],lastWeek:[],lastMonth:[],older:[]})}function Pt({chatId:t,chats:s,deleteChat:r,user:a}){const{setOpenMobile:n}=E(),o=N(),[i,c]=u.useState(null),[g,d]=u.useState(!1),D=async()=>{const x=r(i);Ye.promise(x,{loading:"Deleting chat...",success:()=>"Chat deleted successfully",error:l=>`Failed to delete chat ${l}`}),d(!1),i===t&&o("/")};return s.length===0?e.jsx(A,{children:e.jsx(C,{children:e.jsx("div",{className:"px-2 text-zinc-500 w-full flex flex-row justify-center items-center text-sm gap-2",children:"Your conversations will appear here once you start chatting!"})})}):e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsx(C,{children:e.jsx(w,{children:(()=>{const x=Ot(s);return e.jsxs("div",{className:"flex flex-col gap-6",children:[x.today.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50",children:"Today"}),x.today.map(l=>e.jsx(b,{chat:l,user:a,isActive:l.id===t,onDelete:p=>{c(p),d(!0)},setOpenMobile:n},l.id))]}),x.yesterday.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50",children:"Yesterday"}),x.yesterday.map(l=>e.jsx(b,{chat:l,user:a,isActive:l.id===t,onDelete:p=>{c(p),d(!0)},setOpenMobile:n},l.id))]}),x.lastWeek.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50",children:"Last 7 days"}),x.lastWeek.map(l=>e.jsx(b,{chat:l,user:a,isActive:l.id===t,onDelete:p=>{c(p),d(!0)},setOpenMobile:n},l.id))]}),x.lastMonth.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50",children:"Last 30 days"}),x.lastMonth.map(l=>e.jsx(b,{chat:l,user:a,isActive:l.id===t,onDelete:p=>{c(p),d(!0)},setOpenMobile:n},l.id))]}),x.older.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50",children:"Older than last month"}),x.older.map(l=>e.jsx(b,{chat:l,user:a,isActive:l.id===t,onDelete:p=>{c(p),d(!0)},setOpenMobile:n},l.id))]})]})})()})})}),e.jsx(Dt,{open:g,onOpenChange:d,children:e.jsxs(wt,{children:[e.jsxs(At,{children:[e.jsx(St,{children:"Are you absolutely sure?"}),e.jsx(Mt,{children:"This action cannot be undone. This will permanently delete your chat and remove it from our servers."})]}),e.jsxs(Ct,{children:[e.jsx(_t,{children:"Cancel"}),e.jsx(Tt,{onClick:D,children:"Continue"})]})]})})]})}function Et({user:t}){const s=N(),[r,a]=Be(),n=!!t.id;return e.jsx(w,{children:e.jsx(M,{children:e.jsxs(_,{children:[e.jsx(k,{asChild:!0,children:e.jsxs(T,{"data-testid":"user-nav-button",className:"data-[state=open]:bg-sidebar-accent bg-background data-[state=open]:text-sidebar-accent-foreground h-10",children:[e.jsx("img",{src:`https://avatar.vercel.sh/${t.email}`,alt:t.email??"User Avatar",width:24,height:24,className:"rounded-full"}),e.jsx("span",{"data-testid":"user-email",className:"truncate",children:n?"Guest":t==null?void 0:t.email}),e.jsx(Ue,{className:"ml-auto"})]})}),e.jsxs(P,{"data-testid":"user-nav-menu",side:"top",className:"w-[--radix-popper-anchor-width]",children:[e.jsx(h,{"data-testid":"user-nav-item-theme",className:"cursor-pointer",onSelect:()=>a(r==="dark"?I.LIGHT:I.DARK),children:`Toggle ${r==="light"?"dark":"light"} mode`}),e.jsx(ke,{}),e.jsx(h,{asChild:!0,"data-testid":"user-nav-item-auth",children:e.jsx("button",{type:"button",className:"w-full cursor-pointer",onClick:()=>{s(n?"/login":"/logout")},children:n?"Login to your account":"Sign out"})})]})]})})})}function Rt({chatId:t,agent:s,user:r,isActive:a=!1}){const{setOpenMobile:n}=E(),o=N();return e.jsxs(M,{children:[e.jsx(T,{asChild:!0,isActive:a,children:e.jsx(S,{to:`/agent/${s.id}`,onClick:()=>n(!1),children:e.jsx("span",{children:s.name})})},s.id),e.jsxs(_,{modal:!0,children:[e.jsx(k,{asChild:!0,children:e.jsxs(O,{className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground mr-0.5",showOnHover:!a,children:[e.jsx(B,{}),e.jsx("span",{className:"sr-only",children:"More"})]})}),e.jsxs(P,{side:"bottom",align:"end",children:[r&&e.jsxs(U,{children:[e.jsx(V,{className:"cursor-pointer",children:e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(K,{}),e.jsx("span",{children:"Share"})]})}),e.jsx(q,{children:e.jsxs(J,{children:[e.jsxs(h,{className:"cursor-pointer flex-row justify-between",onClick:()=>{},children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(Q,{size:12}),e.jsx("span",{children:"Private"})]}),s.isPublic?null:e.jsx(y,{})]}),e.jsxs(h,{className:"cursor-pointer flex-row justify-between",onClick:()=>{},children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(X,{}),e.jsx("span",{children:"Public"})]}),s.isPublic?e.jsx(y,{}):null]})]})})]}),e.jsxs(h,{className:"cursor-pointer",onSelect:()=>o(`/agent/${s.id}/edit`),children:[e.jsx(Ke,{}),e.jsx("span",{children:"Edit"})]}),t&&e.jsx(h,{className:"cursor-pointer text-destructive focus:bg-destructive/15 focus:text-destructive dark:text-red-500",asChild:!0,children:e.jsxs(z,{method:"DELETE",action:`/chat/${t}/delete-agent`,children:[e.jsx("input",{type:"hidden",name:"agentId",value:s.id}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 w-full text-left",children:[e.jsx(Z,{}),e.jsx("span",{children:"Delete"})]})]})})]})]})]})}function F({chatId:t,customAgents:s,customAgent:r,user:a}){return e.jsxs(A,{children:[e.jsx(Oe,{className:"flex items-center justify-between",children:e.jsx("span",{children:"Agents"})}),e.jsx(z,{action:"/agent/new",method:"post",className:"contents",children:e.jsx(O,{type:"submit",className:"mr-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:e.jsx(ee,{})})}),e.jsx(C,{children:e.jsx(w,{children:s==null?void 0:s.map(n=>e.jsx(Rt,{chatId:t,agent:n,user:a,isActive:n.id===(r==null?void 0:r.id)},n.id))})})]})}function It({user:t,chatId:s,chats:r,customAgents:a,customAgent:n}){const o=Pe(),i=N(),{setOpenMobile:c}=E();return e.jsxs(Ee,{className:"group-data-[side=left]:border-r-0",children:[e.jsx(Re,{children:e.jsx(w,{children:e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx(S,{to:"/",onClick:()=>{c(!1)},className:"flex flex-row gap-3 items-center",children:e.jsx("span",{className:"text-lg font-semibold px-2 hover:bg-muted rounded-md cursor-pointer",children:"Nanobot"})}),e.jsxs(Ie,{children:[e.jsx($e,{asChild:!0,children:e.jsx(Le,{variant:"ghost",type:"button",className:"p-2 h-fit",onClick:()=>{c(!1),i("/")},children:e.jsx(ee,{})})}),e.jsx(Fe,{align:"end",children:"New Chat"})]})]})})}),e.jsxs(ze,{children:[a&&a.length>0&&e.jsx(F,{chatId:s,customAgents:a,customAgent:n,user:t}),e.jsx(Pt,{chats:r,chatId:s,deleteChat:o,user:t}),!(a!=null&&a.length)&&e.jsx(F,{chatId:s,customAgents:a,customAgent:n,user:t})]}),e.jsx(Ge,{children:t&&e.jsx(Et,{user:t})})]})}const Yt=je(function({loaderData:{chat:s,threads:r,sidebar:a,customAgents:n,user:o}}){var c;const i=a!=="true";return e.jsxs(He,{defaultOpen:!i,children:[e.jsx(It,{chats:r.chats,chatId:s.id,customAgents:(c=n.customAgents)==null?void 0:c.filter(g=>!!g.name),customAgent:s.customAgent,user:o}),e.jsx(We,{children:e.jsx(me,{})})]})});export{Yt as default};
